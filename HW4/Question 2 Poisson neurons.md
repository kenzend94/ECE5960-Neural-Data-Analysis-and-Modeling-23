## Question 2: Poisson Distribution

The Poisson distribution is commonly used to model neural spike counts:
$$ p(k) = \frac{\mu^k e^{-\mu}}{k!} $$

where k is the spike count (over some specified time interval), and $\mu$ is the expected number of spikes over that interval.

  - (a) We would like to know what the Poisson distribution looks like. Set the expected number of spikes to $\mu\ = 6$ spikes/interval then create a vector p of length 21, whose elements contain the probabilities of Poisson spike counts for k = [0...20]. Since we’re clipping the range at a maximum value of 20, you’ll need to normalize the vector so it sums to one (the distribution given above is normalized over the range from 0 to infinity) to make the vector p represent a valid probability distribution. Plot p in a bar plot and mark the mean firing rate. Is it equal to $\(\mu\)$ ?

  - (b) Generate samples from the Poisson distribution where each sample represents the number of spike count ranging from 0 to 20. To simplify the problem, use a clipped Poisson vector p to write a function ```samples = randp(p, num)``` that generates ```num``` samples from the probability distribution function (PDF) specified by ```p```. [Hint: use the ```rand``` function, which generates real values over the interval [0...1], and partition this interval into portions proportional in size to the probabilities in p]. Test your function by drawing 1,000 samples from the Poisson distribution in (a), plotting a histogram of how many times each value is sampled, and comparing this to the frequencies predicted by p. Verify qualitatively that the answer gets closer (converges) as you increase the number of samples (try 10 raised to powers [2; 3; 4; 5]).

  - (c) Imagine you’re recording with an electrode from two neurons simultaneously, whose spikes have very similar waveforms (and thus can’t be distinguished by the spike sorting software). Create a probability vector, q, for the second neuron, assuming a mean rate of 4 spikes/interval. What is the PDF of the observed spike counts, which will be the sum of spike counts from the two neurons derived from p and q? [Hint: the output vector should have length m + n - 1 when m and n are the lengths of the two input PDFs. This is because the maximum spike count will be bigger than the maximum of each respective individual neuron.] Verify your answer by comparing it to the histogram of 1,000 samples generated by summing two calls to ```randp``` (choose a big enough number of samples!).

  - (d) Now imagine you are recording from a neuron with mean rate 10 spikes/interval (the sum of the rates from the neurons above). Plot the distribution of spike counts for this neuron, in comparison with the distribution of the sum of the previous two neurons. Based on the results of these two experiments, if we record a new spike train, can you tell whether the spikes you have recorded came from one or two neurons just by looking at their distribution of spike counts? Comment about the reason why based on the intuition behind Poisson distribution.


### Part a:

We would like to know what the Poisson distribution looks like. Set the expected number of spikes to $\mu\ = 6$ spikes/interval then create a vector p of length 21, whose elements contain the probabilities of Poisson spike counts for k = [0...20]. Since we’re clipping the range at a maximum value of 20, you’ll need to normalize the vector so it sums to one (the distribution given above is normalized over the range from 0 to infinity) to make the vector p represent a valid probability distribution. Plot p in a bar plot and mark the mean firing rate. Is it equal to $\(\mu\)$ ?


    
![png](Question%202%20Poisson%20neurons_files/Question%202%20Poisson%20neurons_3_0.png)
    


Q: Is it equal to $\mu$ ?
A: Yes, the mean firing rate is equal to $\mu$ = 6.

### Part b:

Generate samples from the Poisson distribution where each sample represents the number of spike count ranging from 0 to 20. To simplify the problem, use a clipped Poisson vector p to write a function ```samples = randp(p, num)``` that generates ```num``` samples from the probability distribution function (PDF) specified by ```p```. [Hint: use the ```rand``` function, which generates real values over the interval [0...1], and partition this interval into portions proportional in size to the probabilities in p]. Test your function by drawing 1,000 samples from the Poisson distribution in (a), plotting a histogram of how many times each value is sampled, and comparing this to the frequencies predicted by p. Verify qualitatively that the answer gets closer (converges) as you increase the number of samples (try 10 raised to powers [2; 3; 4; 5]).


    
![png](Question%202%20Poisson%20neurons_files/Question%202%20Poisson%20neurons_6_0.png)
    


Q: Verify qualitatively that the answer gets closer (converges) as you increase the number of samples (try 10 raised to powers [2; 3; 4; 5]).
A: The plots show the histogram getting closer to the mean firing rate shown by the green dashed line as the number of samples increases.

### Part c:

Imagine you’re recording with an electrode from two neurons simultaneously, whose spikes have very similar waveforms (and thus can’t be distinguished by the spike sorting software). Create a probability vector, q, for the second neuron, assuming a mean rate of 4 spikes/interval. What is the PDF of the observed spike counts, which will be the sum of spike counts from the two neurons derived from p and q? [Hint: the output vector should have length m + n - 1 when m and n are the lengths of the two input PDFs. This is because the maximum spike count will be bigger than the maximum of each respective individual neuron.] Verify your answer by comparing it to the histogram of 1,000 samples generated by summing two calls to ```randp``` (choose a big enough number of samples!).


    
![png](Question%202%20Poisson%20neurons_files/Question%202%20Poisson%20neurons_9_0.png)
    


Q: What is the PDF of the observed spike counts, which will be the sum of spike counts from the two neurons derived from p and q?
A: The PDF of the observed spike counts is the convolution of the two individual neuron's PDFs.

Q: Verify your answer by comparing it to the histogram of 1,000 samples generated by summing two calls to randp (choose a big enough number of samples!).
A: The histogram of the 1000 samples generated by summing two calls to randp is very similar to the convolution of the two individual neuron's PDFs. The highest point of the histogram meets the peak of the predicted line.

### Part d:

Now imagine you are recording from a neuron with mean rate 10 spikes/interval (the sum of the rates from the neurons above). Plot the distribution of spike counts for this neuron, in comparison with the distribution of the sum of the previous two neurons. Based on the results of these two experiments, if we record a new spike train, can you tell whether the spikes you have recorded came from one or two neurons just by looking at their distribution of spike counts? Comment about the reason why based on the intuition behind Poisson distribution.


    
![png](Question%202%20Poisson%20neurons_files/Question%202%20Poisson%20neurons_13_0.png)
    


Q: Based on the results of these two experiments, if we record a new spike train, can you tell whether the spikes you have recorded came from one or two neurons just by looking at their distribution of spike counts?
A: We can't tell if spikes are from one or two neurons just by the count. Both scenarios give similar patterns if the average rate is the same.

Q: Comment about the reason why based on the intuition behind Poisson distribution.
A: The Poisson distribution shows the likelihood of event counts—like neuron spikes—over time, assuming a constant average rate. This makes the spike pattern from one neuron with a mean rate of 10 similar to the combined pattern of two neurons with rates of 6 and 4.
